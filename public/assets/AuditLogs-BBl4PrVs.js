import{a as b}from"./index-WsV9NrLY.js";import{r as x}from"./request-DAKZCXKs.js";import{d as w,K as N,o as C,L as m,M as f,O as y,u as t,E as s,B as g,U as B,P as D,r as l,D as _,a1 as z,ae as S,ao as I,Y as P}from"./naive-ui-BdchKIzk.js";import{R as L}from"./RefreshOutline-CFFu2u4W.js";const M={class:"flex items-center justify-between mb-4"},O={key:0,class:"flex justify-end mt-4"},E=w({__name:"AuditLogs",setup(R){const v=N(),r=b(),o=l(!1),i=l([]),n=l(0),d=l(1),u=l(20),h=[{title:"ID",key:"id",width:60},{title:"时间",key:"created_at",width:170,render:e=>{var a;return((a=e.created_at)==null?void 0:a.replace("T"," ").slice(0,19))||"-"}},{title:"用户",key:"username",width:100,render:e=>{var a;return((a=e.user)==null?void 0:a.username)||e.username||"-"}},{title:"操作",key:"action",width:120},{title:"资源类型",key:"resource_type",width:120},{title:"资源ID",key:"resource_id",width:80},{title:"IP地址",key:"ip_address",width:130},{title:"详情",key:"details",ellipsis:!0,render:e=>JSON.stringify(e.details||e.changes||{})}];async function c(){var e,a;o.value=!0;try{const p=await x.get("/audit-logs",{params:{page:d.value,per_page:u.value}});i.value=((e=p.data)==null?void 0:e.data)||p.data||[],n.value=((a=p.data)==null?void 0:a.total)||i.value.length}catch{v.error("加载失败")}finally{o.value=!1}}function k(e){d.value=e,c()}return C(c),(e,a)=>(_(),m("div",null,[f("div",M,[f("h2",{class:"text-lg font-semibold",style:y({color:t(r).isDark?"#fff":"#1a1a1a"})}," 审计日志 ",4),s(t(B),{quaternary:"",circle:"",onClick:c,loading:o.value},{icon:g(()=>[s(t(z),null,{default:g(()=>[s(t(L))]),_:1})]),_:1},8,["loading"])]),s(t(D),{style:y({backgroundColor:t(r).cardBg,backdropFilter:"blur(12px)",borderRadius:"12px",border:t(r).isDark?"1px solid rgba(255,255,255,0.06)":"1px solid rgba(0,0,0,0.06)"})},{default:g(()=>[s(t(S),{columns:h,data:i.value,loading:o.value,bordered:!1,striped:"",size:"small"},null,8,["data","loading"]),n.value>u.value?(_(),m("div",O,[s(t(I),{page:d.value,"page-size":u.value,"item-count":n.value,"onUpdate:page":k},null,8,["page","page-size","item-count"])])):P("",!0)]),_:1},8,["style"])]))}});export{E as default};
