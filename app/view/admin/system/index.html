{extend name="admin/layout" /}
{block name="content"}
<style>
.svc-card { background:#fff; border-radius:8px; padding:24px 16px; text-align:center; box-shadow:0 1px 4px rgba(0,0,0,.08); }
.svc-name { font-size:15px; font-weight:bold; color:#333; margin-bottom:12px; }
.svc-version { font-size:28px; font-weight:bold; color:#333; margin:10px 0 4px; line-height:1.2; }
.svc-detail { font-size:12px; color:#aaa; margin-top:8px; word-break:break-all; }
.ext-badge { display:inline-block; margin:3px; padding:2px 10px; border-radius:10px; font-size:12px; }
.ext-ok  { background:#e8f8f2; color:#29a96a; }
.ext-no  { background:#fdf0f0; color:#d9534f; }
</style>

<!-- 服务状态 -->
<div class="layui-card" style="margin-bottom:15px;">
    <div class="layui-card-header">服务状态</div>
    <div class="layui-card-body" style="padding:20px;">
        <div class="layui-row layui-col-space15">
            {volist name="services" id="svc"}
            <div class="layui-col-xs4">
                <div class="svc-card">
                    <div class="svc-name">{{$svc['name']}}</div>
                    {if $svc['ok']}
                    <div><span class="layui-badge layui-bg-green" style="font-size:13px;padding:4px 16px;">● 正常</span></div>
                    {else/}
                    <div><span class="layui-badge" style="font-size:13px;padding:4px 16px;background:#e74c3c;">● 异常</span></div>
                    {/if}
                    {if $svc['version'] != '-'}
                    <div class="svc-version">{{$svc['version']}}</div>
                    {/if}
                    <div class="svc-detail">{{$svc['detail']}}</div>
                </div>
            </div>
            {/volist}
        </div>
    </div>
</div>

<!-- PHP 环境 -->
<div class="layui-row layui-col-space15" style="margin-bottom:15px;">
    <div class="layui-col-xs6">
        <div class="layui-card" style="margin-bottom:0;">
            <div class="layui-card-header">PHP 环境</div>
            <div class="layui-card-body">
                <table class="layui-table" lay-skin="line">
                    <tbody>
                        <tr>
                            <td style="width:120px;color:#999;">PHP 版本</td>
                            <td><strong>{{$phpVersion}}</strong></td>
                        </tr>
                        <tr>
                            <td style="color:#999;">运行模式</td>
                            <td>Workerman / CLI</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="layui-col-xs6">
        <div class="layui-card" style="margin-bottom:0;">
            <div class="layui-card-header">关键扩展</div>
            <div class="layui-card-body" style="padding:14px 18px;">
                {volist name="checkExts" id="ext"}
                {php}$loaded = in_array($ext, $loadedExts);{/php}
                <span class="ext-badge {{$loaded ? 'ext-ok' : 'ext-no'}}">
                    {{$loaded ? '✓' : '✗'}} {{$ext}}
                </span>
                {/volist}
            </div>
        </div>
    </div>
</div>

<!-- 依赖组件版本 -->
<div class="layui-card">
    <div class="layui-card-header">依赖组件版本</div>
    <div class="layui-card-body">
        <table class="layui-table" lay-skin="line">
            <colgroup><col width="200"><col><col width="130"></colgroup>
            <thead>
                <tr>
                    <th>组件</th>
                    <th>包名</th>
                    <th>版本</th>
                </tr>
            </thead>
            <tbody>
                {volist name="packages" id="pkg"}
                <tr>
                    <td>{{$pkg['label']}}</td>
                    <td style="color:#999;font-size:12px;">{{$pkg['package']}}</td>
                    <td><span class="layui-badge layui-bg-blue">{{$pkg['version']}}</span></td>
                </tr>
                {/volist}
            </tbody>
        </table>
    </div>
</div>
{/block}
